{
  "Serilog": {
    "Using": ["Serilog.Sinks.File", "Serilog.Sinks.EventLog"],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning",
        "Microsoft.AspNetCore": "Warning",
        "Microsoft.Hosting.Lifetime": "Information"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss} [{Level:u3}] {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "App_Data\\logs\\file-conversion-api-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": ["FromLogContext", "WithMachineName", "WithThreadId"]
  },
  "AllowedHosts": "*",
  "FileHandling": {
    "UploadLimit": "50mb",
    "MaxFileSize": 52428800,
    "MaxFilesPerRequest": 5,
    "TempDirectory": "App_Data\\temp\\uploads",
    "OutputDirectory": "App_Data\\temp\\converted",
    "UseWindowsPaths": true,
    "UseNTFSPermissions": true,
    "CleanupTempFiles": true,
    "TempFileRetentionHours": 24,
    "AllowedExtensions": [
      "pdf",
      "doc",
      "docx",
      "xls",
      "xlsx",
      "ppt",
      "pptx",
      "txt",
      "rtf",
      "odt",
      "ods",
      "odp",
      "odg",
      "odf",
      "sxw",
      "sxc",
      "sxi",
      "sxd",
      "html",
      "htm",
      "xml",
      "csv"
    ],
    "BlockedExtensions": [
      "exe",
      "bat",
      "cmd",
      "com",
      "pif",
      "scr",
      "vbs",
      "js",
      "jar",
      "dll",
      "ocx",
      "cpl",
      "drv",
      "sys",
      "386"
    ]
  },
  "Security": {
    "IPWhitelist": [
      "192.168.0.0/16",
      "10.0.0.0/8",
      "172.16.0.0/12",
      "127.0.0.1",
      "localhost"
    ],
    "EnableIPFiltering": false,
    "EnableRateLimiting": true,
    "MaxRequestSize": 52428800,
    "RequestTimeoutSeconds": 300
  },
  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "HttpStatusCode": 429,
    "RealIpHeader": "X-Real-IP",
    "ClientIdHeader": "X-ClientId",
    "GeneralRules": [
      { "Endpoint": "*", "Period": "1m", "Limit": 30 },
      { "Endpoint": "POST:/api/convert", "Period": "1m", "Limit": 10 },
      { "Endpoint": "GET:/health", "Period": "1m", "Limit": 60 }
    ],
    "IpWhitelist": ["192.168.1.0/24", "10.0.0.0/8"]
  },
  "SecurityHeaders": {
    "NoSniff": true,
    "ReferrerPolicy": "strict-origin-when-cross-origin",
    "FrameOptions": "DENY",
    "XssProtection": "1; mode=block",
    "ContentSecurityPolicy": "default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'"
  },
  "Network": {
    "AllowLocalhost": true,
    "MaxConcurrentConnections": 100,
    "RequestTimeout": 300000
  },
  "LibreOffice": {
    "ExecutablePath": "",
    "TimeoutSeconds": 300
  },
  "Concurrency": {
    "MaxConcurrentConversions": 2,
    "MaxQueueSize": 10
  },
  "Preprocessing": {
    "EnableDocxPreprocessing": true,
    "NormalizeFonts": true,
    "ConvertColors": true,
    "FixTextEffects": true,
    "OptimizeImages": false,
    "RemoveMacros": true,
    "ValidateStructure": true
  }
}
