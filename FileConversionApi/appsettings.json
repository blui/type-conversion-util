{
  // ============================================================================
  // FILE CONVERSION API - PRODUCTION CONFIGURATION FOR IIS
  // Optimized for Windows Server IIS deployment with intranet-only access
  // ============================================================================

  // ASP.NET Core Logging Configuration
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "FileConversionApi": "Information"
    },
    "EventLog": {
      "LogLevel": {
        "Default": "Information",
        "Microsoft.AspNetCore": "Warning"
      }
    }
  },

  // Serilog Configuration for production logging
  "Serilog": {
    "Using": ["Serilog.Sinks.File", "Serilog.Sinks.EventLog"],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning",
        "Microsoft.AspNetCore": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "File",
        "Args": {
          "path": "C:\\inetpub\\logs\\file-conversion-api-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        "Name": "EventLog",
        "Args": {
          "source": "FileConversionApi",
          "logName": "Application"
        }
      }
    ],
    "Enrich": ["FromLogContext", "WithMachineName", "WithThreadId"]
  },

  // Allowed Hosts (restrict to internal network for production)
  "AllowedHosts": "*",

  // ============================================================================
  // APPLICATION CONFIGURATION
  // ============================================================================
  "Application": {
    "Name": "File Conversion API",
    "Version": "2.0.0",
    "Environment": "Production"
  },

  // ============================================================================
  // FILE HANDLING CONFIGURATION
  // ============================================================================
  "FileHandling": {
    "UploadLimit": "50mb",
    "MaxFileSize": 52428800,
    "MaxFilesPerRequest": 5,
    "TempDirectory": "App_Data\\temp\\uploads",
    "OutputDirectory": "App_Data\\temp\\converted",
    "UseWindowsPaths": true,
    "UseNTFSPermissions": true,
    "CleanupTempFiles": true,
    "TempFileRetentionHours": 24,
    "AllowedExtensions": [
      "pdf",
      "doc",
      "docx",
      "xls",
      "xlsx",
      "ppt",
      "pptx",
      "txt",
      "rtf",
      "odt",
      "ods",
      "odp",
      "odg",
      "odf",
      "sxw",
      "sxc",
      "sxi",
      "sxd",
      "html",
      "htm",
      "xml",
      "csv"
    ],
    "BlockedExtensions": [
      "exe",
      "bat",
      "cmd",
      "com",
      "pif",
      "scr",
      "vbs",
      "js",
      "jar",
      "dll",
      "ocx",
      "cpl",
      "drv",
      "sys",
      "386"
    ]
  },

  // ============================================================================
  // SECURITY CONFIGURATION
  // ============================================================================
  "Security": {
    "IPWhitelist": [
      "192.168.0.0/16",
      "10.0.0.0/8",
      "172.16.0.0/12",
      "127.0.0.1",
      "localhost"
    ],
    "EnableAdvancedSecurity": true,
    "EnableRequestLogging": true,
    "EnableRateLimiting": true,
    "EnableIPFiltering": true,
    "MaxRequestSize": 52428800,
    "RequestTimeoutSeconds": 300,
    "EnableHsts": false,
    "HstsMaxAge": 31536000,
    "EnableCors": false
  },

  // IP Rate Limiting Configuration
  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "HttpStatusCode": 429,
    "RealIpHeader": "X-Real-IP",
    "ClientIdHeader": "X-ClientId",
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1m",
        "Limit": 30
      },
      {
        "Endpoint": "POST:/api/convert",
        "Period": "1m",
        "Limit": 10
      },
      {
        "Endpoint": "GET:/health",
        "Period": "1m",
        "Limit": 60
      }
    ],
    "IpWhitelist": ["192.168.1.0/24", "10.0.0.0/8"]
  },

  // Windows Authentication (for internal networks)
  "WindowsSecurity": {
    "UseWindowsAuthentication": false,
    "ApplicationPoolIdentity": "ApplicationPoolIdentity",
    "ImpersonateCaller": false,
    "RequireWindowsAuthentication": false,
    "EnableAnonymousAccess": true
  },

  // ============================================================================
  // NETWORK CONFIGURATION
  // ============================================================================
  "Network": {
    "BindToInternalInterface": true,
    "InternalNetworkRanges": ["192.168.0.0/16", "10.0.0.0/8", "172.16.0.0/12"],
    "AllowLocalhost": true,
    "TrustProxy": false,
    "KeepAlive": true,
    "KeepAliveTimeout": 65000,
    "MaxConcurrentConnections": 100,
    "RequestTimeout": 300000
  },

  // CORS Configuration (disabled for internal networks)
  "Cors": {
    "AllowAnyOrigin": false,
    "AllowAnyMethod": false,
    "AllowAnyHeader": false,
    "AllowCredentials": false,
    "AllowedOrigins": [],
    "AllowedMethods": ["GET", "POST"],
    "AllowedHeaders": ["Content-Type", "Authorization"]
  },

  // Security Headers Configuration
  "SecurityHeaders": {
    "ContentSecurityPolicy": "default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self'",
    "Hsts": {
      "Enabled": false,
      "MaxAge": 31536000,
      "IncludeSubDomains": false,
      "Preload": false
    },
    "NoSniff": true,
    "ReferrerPolicy": "strict-origin-when-cross-origin",
    "FrameOptions": "DENY",
    "XssProtection": "1; mode=block",
    "CrossOriginEmbedderPolicy": "require-corp",
    "CrossOriginOpenerPolicy": "same-origin",
    "CrossOriginResourcePolicy": "same-origin"
  },

  // ============================================================================
  // LIBREOFFICE CONFIGURATION
  // ============================================================================
  "LibreOffice": {
    "SdkPath": "C:\\Program Files\\LibreOfficeSDK",
    "ExecutablePath": "",
    "ForceBundled": false,
    "UseSdkIntegration": false,
    "ConversionQuality": "high",
    "TimeoutSeconds": 300,
    "MaxConcurrentConversions": 2,
    "EnableLogging": true,
    "TempDirectory": "App_Data\\temp\\libreoffice",
    "SupportedFormats": [
      "pdf",
      "doc",
      "docx",
      "xls",
      "xlsx",
      "ppt",
      "pptx",
      "txt",
      "rtf",
      "odt",
      "ods",
      "odp",
      "odg",
      "odf",
      "sxw",
      "sxc",
      "sxi",
      "sxd"
    ]
  },

  // ============================================================================
  // PERFORMANCE & CONCURRENCY
  // ============================================================================
  "Concurrency": {
    "MaxConcurrentConversions": 2,
    "MaxQueueSize": 10,
    "ThreadPoolSettings": {
      "MinThreads": 4,
      "MaxThreads": 16
    }
  },

  // Conversion Timeouts (in milliseconds)
  "Timeouts": {
    "DocumentConversion": 60000,
    "HttpClientTimeout": 30000,
    "FileOperationTimeout": 15000,
    "DatabaseTimeout": 30000
  },

  // ============================================================================
  // MONITORING & HEALTH CHECKS
  // ============================================================================
  "HealthChecks": {
    "Enabled": true,
    "Path": "/health",
    "DetailedPath": "/health/detailed",
    "Timeout": 5000,
    "IncludeSystemInfo": true,
    "IncludePerformanceMetrics": true,
    "FailureThreshold": 3,
    "Interval": 30000
  },

  "PerformanceMonitoring": {
    "Enabled": true,
    "MetricsRetentionHours": 24,
    "EnableDetailedLogging": false,
    "TrackConversionMetrics": true,
    "TrackSystemMetrics": true
  },

  // ============================================================================
  // PREPROCESSING CONFIGURATION
  // ============================================================================
  "Preprocessing": {
    "EnableDocxPreprocessing": true,
    "NormalizeFonts": true,
    "ConvertColors": true,
    "FixTextEffects": true,
    "OptimizeImages": false,
    "RemoveMacros": true,
    "ValidateStructure": true
  },

  // ============================================================================
  // DATABASE CONFIGURATION (if needed in future)
  // ============================================================================
  "Database": {
    "Provider": "None",
    "ConnectionString": "",
    "EnableMetrics": false,
    "CommandTimeout": 30,
    "MaxPoolSize": 10,
    "MinPoolSize": 1
  },

  // ============================================================================
  // CACHE CONFIGURATION
  // ============================================================================
  "Cache": {
    "Enabled": false,
    "Provider": "Memory",
    "Redis": {
      "ConnectionString": "",
      "InstanceName": "FileConversion",
      "DefaultDatabase": 0
    },
    "Memory": {
      "SizeLimit": 104857600,
      "CompactionPercentage": 0.05,
      "ExpirationScanFrequency": 3600
    }
  },

  // ============================================================================
  // SSL & CERTIFICATE CONFIGURATION
  // ============================================================================
  "SSL": {
    "Enabled": false,
    "CertificatePath": "",
    "CertificatePassword": "",
    "AcceptSelfSigned": true,
    "UseWindowsCertificateStore": true,
    "CertificateThumbprint": "",
    "CertificateStoreLocation": "LocalMachine",
    "CertificateStoreName": "My",
    "RequireClientCertificate": false,
    "ClientCertificateValidation": false
  },

  // ============================================================================
  // EXTERNAL SERVICE CONFIGURATION
  // ============================================================================
  "ExternalServices": {
    "EnableVirusScanning": false,
    "VirusScanner": {
      "Url": "",
      "ApiKey": "",
      "Timeout": 30000
    },
    "EnableContentAnalysis": false,
    "ContentAnalyzer": {
      "Url": "",
      "ApiKey": "",
      "Timeout": 30000
    }
  },

  // ============================================================================
  // MAINTENANCE & CLEANUP
  // ============================================================================
  "Maintenance": {
    "EnableAutoCleanup": true,
    "CleanupIntervalHours": 24,
    "TempFileRetentionHours": 24,
    "LogRetentionDays": 7,
    "MetricsRetentionDays": 30,
    "EnableBackup": false,
    "BackupIntervalHours": 24,
    "BackupDirectory": "App_Data\\backups"
  },

  // ============================================================================
  // DEVELOPMENT & DEBUGGING
  // ============================================================================
  "Development": {
    "EnableSwagger": true,
    "EnableDeveloperExceptionPage": false,
    "EnableDetailedErrors": false,
    "LogRequestResponse": false,
    "EnableRequestLogging": true,
    "EnablePerformanceLogging": false
  },

  // ============================================================================
  // WINDOWS SERVICE CONFIGURATION (optional)
  // ============================================================================
  "WindowsService": {
    "Enabled": false,
    "ServiceName": "FileConversionApi",
    "DisplayName": "File Conversion API Service",
    "Description": "REST API service for document and file conversions",
    "StartType": "Automatic",
    "Account": "LocalSystem",
    "Username": "",
    "Password": "",
    "RestartOnFailure": true,
    "RestartDelay": 5000
  }
}
