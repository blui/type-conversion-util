{
    "Security":  {
                     "MaxRequestSize":  52428800,
                     "RequestTimeoutSeconds":  300,
                     "IPWhitelist":  [
                                         "192.168.0.0/16",
                                         "10.0.0.0/8",
                                         "172.16.0.0/12",
                                         "127.0.0.1",
                                         "localhost"
                                     ],
                     "EnableIPFiltering":  false,
                     "EnableRateLimiting":  true
                 },
    "Logging":  {
                    "LogLevel":  {
                                     "Microsoft.Hosting.Lifetime":  "Information",
                                     "Default":  "Information",
                                     "FileConversionApi":  "Information",
                                     "Microsoft.AspNetCore":  "Warning"
                                 },
                    "EventLog":  {
                                     "LogLevel":  {
                                                      "Microsoft.AspNetCore":  "Warning",
                                                      "Default":  "Information"
                                                  }
                                 }
                },
    "Timeouts":  {
                     "FileOperationTimeout":  15000,
                     "DocumentConversion":  60000
                 },
    "Serilog":  {
                    "MinimumLevel":  {
                                         "Default":  "Information",
                                         "Override":  {
                                                          "Microsoft":  "Warning",
                                                          "System":  "Warning",
                                                          "Microsoft.AspNetCore":  "Warning"
                                                      }
                                     },
                    "Enrich":  [
                                   "FromLogContext",
                                   "WithMachineName",
                                   "WithThreadId"
                               ],
                    "Using":  [
                                  "Serilog.Sinks.File",
                                  "Serilog.Sinks.EventLog"
                              ],
                    "WriteTo":  [
                                    {
                                        "Args":  {
                                                     "path":  "C:\\inetpub\\logs\\file-conversion-api-.log",
                                                     "retainedFileCountLimit":  30,
                                                     "rollingInterval":  "Day",
                                                     "outputTemplate":  "{Timestamp:yyyy-MM-dd HH:mm:ss.fff} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
                                                 },
                                        "Name":  "File"
                                    },
                                    {
                                        "Args":  {
                                                     "logName":  "Application",
                                                     "source":  "FileConversionApi"
                                                 },
                                        "Name":  "EventLog"
                                    }
                                ]
                },
    "SecurityHeaders":  {
                            "NoSniff":  true,
                            "FrameOptions":  "DENY",
                            "ReferrerPolicy":  "strict-origin-when-cross-origin",
                            "XssProtection":  "1; mode=block",
                            "ContentSecurityPolicy":  "default-src \u0027self\u0027; style-src \u0027self\u0027 \u0027unsafe-inline\u0027; script-src \u0027self\u0027 \u0027unsafe-inline\u0027"
                        },
    "AllowedHosts":  "*",
    "Development":  {
                        "EnableDetailedErrors":  false,
                        "EnableSwagger":  true,
                        "EnableRequestLogging":  true
                    },
    "Preprocessing":  {
                          "ValidateStructure":  true,
                          "OptimizeImages":  false,
                          "FixTextEffects":  true,
                          "NormalizeFonts":  true,
                          "RemoveMacros":  true,
                          "EnableDocxPreprocessing":  true,
                          "ConvertColors":  true
                      },
    "Concurrency":  {
                        "MaxConcurrentConversions":  2,
                        "MaxQueueSize":  10,
                        "ThreadPoolSettings":  {
                                                   "MaxThreads":  16,
                                                   "MinThreads":  4
                                               }
                    },
    "IpRateLimiting":  {
                           "RealIpHeader":  "X-Real-IP",
                           "IpWhitelist":  [
                                               "192.168.1.0/24",
                                               "10.0.0.0/8"
                                           ],
                           "StackBlockedRequests":  false,
                           "ClientIdHeader":  "X-ClientId",
                           "HttpStatusCode":  429,
                           "EnableEndpointRateLimiting":  true,
                           "GeneralRules":  [
                                                {
                                                    "Endpoint":  "*",
                                                    "Limit":  30,
                                                    "Period":  "1m"
                                                },
                                                {
                                                    "Endpoint":  "POST:/api/convert",
                                                    "Limit":  10,
                                                    "Period":  "1m"
                                                },
                                                {
                                                    "Endpoint":  "GET:/health",
                                                    "Limit":  60,
                                                    "Period":  "1m"
                                                }
                                            ]
                       },
    "LibreOffice":  {
                        "ForceBundled":  false,
                        "TimeoutSeconds":  300,
                        "SdkPath":  "C:\\Program Files\\LibreOfficeSDK",
                        "SupportedFormats":  [
                                                 "pdf",
                                                 "doc",
                                                 "docx",
                                                 "xls",
                                                 "xlsx",
                                                 "ppt",
                                                 "pptx",
                                                 "txt",
                                                 "rtf",
                                                 "odt",
                                                 "ods",
                                                 "odp",
                                                 "odg",
                                                 "odf",
                                                 "sxw",
                                                 "sxc",
                                                 "sxi",
                                                 "sxd"
                                             ],
                        "ExecutablePath":  "",
                        "MaxConcurrentConversions":  2,
                        "ConversionQuality":  "high",
                        "EnableLogging":  true,
                        "UseSdkIntegration":  false,
                        "TempDirectory":  "App_Data\\temp\\libreoffice"
                    },
    "FileHandling":  {
                         "MaxFilesPerRequest":  5,
                         "TempDirectory":  "App_Data\\temp\\uploads",
                         "UseNTFSPermissions":  true,
                         "UploadLimit":  "50mb",
                         "MaxFileSize":  52428800,
                         "CleanupTempFiles":  true,
                         "TempFileRetentionHours":  24,
                         "OutputDirectory":  "App_Data\\temp\\converted",
                         "AllowedExtensions":  [
                                                   "pdf",
                                                   "doc",
                                                   "docx",
                                                   "xls",
                                                   "xlsx",
                                                   "ppt",
                                                   "pptx",
                                                   "txt",
                                                   "rtf",
                                                   "odt",
                                                   "ods",
                                                   "odp",
                                                   "odg",
                                                   "odf",
                                                   "sxw",
                                                   "sxc",
                                                   "sxi",
                                                   "sxd",
                                                   "html",
                                                   "htm",
                                                   "xml",
                                                   "csv"
                                               ],
                         "UseWindowsPaths":  true,
                         "BlockedExtensions":  [
                                                   "exe",
                                                   "bat",
                                                   "cmd",
                                                   "com",
                                                   "pif",
                                                   "scr",
                                                   "vbs",
                                                   "js",
                                                   "jar",
                                                   "dll",
                                                   "ocx",
                                                   "cpl",
                                                   "drv",
                                                   "sys",
                                                   "386"
                                               ]
                     },
    "HealthChecks":  {
                         "Path":  "/health",
                         "IncludeSystemInfo":  true,
                         "Timeout":  5000,
                         "DetailedPath":  "/health/detailed",
                         "Enabled":  true
                     },
    "Maintenance":  {
                        "TempFileRetentionHours":  24,
                        "EnableAutoCleanup":  true,
                        "LogRetentionDays":  7
                    },
    "Network":  {
                    "MaxConcurrentConnections":  100,
                    "RequestTimeout":  300000,
                    "AllowLocalhost":  true
                }
}
